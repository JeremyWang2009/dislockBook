{"index":{"version":"0.5.12","fields":[{"name":"title","boost":10},{"name":"keywords","boost":15},{"name":"body","boost":1}],"ref":"url","documentStore":{"store":{"./":["introduct"],"content.html":["\"7663e69f","%e5%ae%8c%e7%be%8e%e7%9a%84%e5%88%86%e5%b8%83%e5%bc%8f%e9%94%81%e4%b9%88%ef%bc%9f/","'if","(integer)","//","0","1","100%","127.0.0.1:6379>","2.8","2e9a2f16d478\"","30000","30000。","4c77","9153","==","argv[1]","a：无死锁，即便持有锁的客户端崩溃，锁仍然可以释放","base","b：容错性，只要大部分","db、redis、zookeep","del","dfee","end'","eval","exist,即","expir","failov","https://redis.io/topics/distlock","https://redis.io/topics/transact","https://www.xilidou.com/2017/10/29/redi","jvm","lock_key","lua","master","nx","nx、expir","ok","px","redi","redis.call(\"del\",keys[1])","redis.call(\"get\",keys[1])","redlock","redlock。对于使用分布式的目的可以参考这篇文章","redssion；问题（3）的解决方案可以参考","request_id；nx","return","sentinel","set","setnx","slave","transcat","unique_valu","unique_value，在解锁之前先判断","valu","上述代码是通过","上述操作其实忽略了一个问题，","上述罗列的三个问题，生产环境都是小概率场景，但是为了避免，问题（1）建议分布式锁不要应用于时间较长的接口或任务；问题（2）一般业务使用到分布式锁都不会用到重入性，如需用到，可自行封装，也可以引用","不存在时，我们进行","不支持重入性","之前，master","之间系统出现异常或者奔溃了，也会导致死锁。或许会有人想到","事务不确保原子性（参考：","值一样，则删除锁，这样能避免其他客户端删除该锁。那为什么用","分布式锁的实现","分布式锁解决的场景就是有点像我们平常玩的“抢椅子”游戏，当有人占用时，其他人只能放弃或者稍后重试。一般获取锁可以用","即便按照上述要求实现了分布式锁，分布式锁也不是","参考阅读","可以理解为","可重入性，是指线程在持有锁的情况下再次请求该锁，如果一个锁支持同一个线程多次添加锁，那么这个锁就是支持重入性的。单纯的","命令不支持，需要自己进行封装","命令同时设置","命令直接操作，这样就会导致任意客户端都可以进行解锁。为了安全起见，应该只有加锁的拥有者能解锁，所以参考","和","大多数公司仅仅只作为缓存，不作为持久化工具。对于分布式锁存在的问题总结如下：","如果获取锁和释放锁之间，接口出现超时，以至于超出了锁的过期时间，会导致并发执行临界区程序。","安全属性：独占（相互排斥），在任意一个时刻，最多只有一个客户端持有该锁","完美的分布式锁么？，对于严格要求的场景（比如订单、金额），即便使用分布式锁，也不能保证锁的正确性，其他非严格场景，可以参考自己的业务是否能容忍这种小概率事件了。","宕机了，slave","实现一个分布式锁最基本的需要满足三点：","实现分布式锁的方式大致有三种，分别是基于","客户端从","对应的值，如果","将锁同步到","已经存在，不做任何操作；px","当业务发展到一定程度的时候，集群环境搭建服务就在所难免，集群环境不同于单机环境，单纯的","指令删除就行。但是有个问题，如果程序执行到中间系统出现异常或者奔溃了，可能会导致","指令没被调用，这样就会出现死锁问题。于是我们想到","指令的时候这个锁已经自动失效了（接口超时情况下可能会出现），不是该客户端锁持有的锁了，所以为了安全起见，redi","指令，只允许被一个客户端占用，想离开时，只需要调用","接口超时问题","操作","操作，若","是一条指令，","是两个指令，也不是原子性的，所以可能会出现调用","是两个指令，在setnx","是否和客户端添加锁的","是否相等，相等则执行如下","服务器会单线程原子性的执行","服务器保证","概述","活性","添加过期时间，具体时间就是后面的","版本开始支持","的","的事务，但是","的值和获取锁设置的","的值是否相等，如果相等，才能解锁，于是就有了下面的命令行解锁：","的意思是","的时候给命令加一个","程序里面判断","等参数，具体代码如下：","给","脚本在处理的过程中不受外界打扰而中断。","脚本实现的，先获取","脚本实现？redi","脚本该应用了，代码如下：","脚本，保证","节点获取锁，master","节点被晋级为","节点都活着，客户端仍然可以获取和释放锁","节点，此时也会出现并发执行临界区程序。","获取锁","过期时间，但是这种也容易出现问题，setnx","这三种。下面将讲解这三种分布式锁的具体实现方式。","这个值在所有获取客户端必须是唯一的，唯一性是为了后面释放锁的时候避免其他客户端释放该锁，unique_valu","这个命令行","释放锁","释放锁大家首先会想到","里面说的添加","锁不再有意义，分布式锁自然应用而生，分布式锁可以有效解决程序的并发执行。","锁的实现","锁的要求","锁的问题","集群主从发生","靠谱的，redi","）。但是从"]},"length":2},"tokenStore":{"root":{"0":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}},"1":{"0":{"0":{"docs":{},"%":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"docs":{}},"2":{"7":{"docs":{},".":{"0":{"docs":{},".":{"0":{"docs":{},".":{"1":{"docs":{},":":{"6":{"3":{"7":{"9":{"docs":{},">":{"docs":{"content.html":{"ref":"content.html","tf":0.021164021164021163}}}},"docs":{}},"docs":{}},"docs":{}},"docs":{}}},"docs":{}}},"docs":{}}},"docs":{}}},"docs":{}},"docs":{"content.html":{"ref":"content.html","tf":0.021164021164021163}}},"2":{"docs":{},".":{"8":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}},"docs":{}},"e":{"9":{"docs":{},"a":{"2":{"docs":{},"f":{"1":{"6":{"docs":{},"d":{"4":{"7":{"8":{"docs":{},"\"":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"docs":{}},"docs":{}},"docs":{}}},"docs":{}},"docs":{}}},"docs":{}}},"docs":{}}},"3":{"0":{"0":{"0":{"0":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}},"。":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"docs":{}},"docs":{}},"docs":{}},"docs":{}},"4":{"docs":{},"c":{"7":{"7":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}},"docs":{}},"docs":{}}},"9":{"1":{"5":{"3":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}},"docs":{}},"docs":{}},"docs":{}},"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"r":{"docs":{},"o":{"docs":{},"d":{"docs":{},"u":{"docs":{},"c":{"docs":{},"t":{"docs":{"./":{"ref":"./","tf":11}}}}}}}}}}},"\"":{"7":{"6":{"6":{"3":{"docs":{},"e":{"6":{"9":{"docs":{},"f":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"docs":{}},"docs":{}}},"docs":{}},"docs":{}},"docs":{}},"docs":{}},"%":{"docs":{},"e":{"5":{"docs":{},"%":{"docs":{},"a":{"docs":{},"e":{"docs":{},"%":{"8":{"docs":{},"c":{"docs":{},"%":{"docs":{},"e":{"7":{"docs":{},"%":{"docs":{},"b":{"docs":{},"e":{"docs":{},"%":{"8":{"docs":{},"e":{"docs":{},"%":{"docs":{},"e":{"7":{"docs":{},"%":{"9":{"docs":{},"a":{"docs":{},"%":{"8":{"4":{"docs":{},"%":{"docs":{},"e":{"5":{"docs":{},"%":{"8":{"8":{"docs":{},"%":{"8":{"6":{"docs":{},"%":{"docs":{},"e":{"5":{"docs":{},"%":{"docs":{},"b":{"8":{"docs":{},"%":{"8":{"3":{"docs":{},"%":{"docs":{},"e":{"5":{"docs":{},"%":{"docs":{},"b":{"docs":{},"c":{"docs":{},"%":{"8":{"docs":{},"f":{"docs":{},"%":{"docs":{},"e":{"9":{"docs":{},"%":{"9":{"4":{"docs":{},"%":{"8":{"1":{"docs":{},"%":{"docs":{},"e":{"4":{"docs":{},"%":{"docs":{},"b":{"9":{"docs":{},"%":{"8":{"8":{"docs":{},"%":{"docs":{},"e":{"docs":{},"f":{"docs":{},"%":{"docs":{},"b":{"docs":{},"c":{"docs":{},"%":{"9":{"docs":{},"f":{"docs":{},"/":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}},"docs":{}}}}}}}}},"docs":{}},"docs":{}}},"docs":{}}}},"docs":{}}}},"docs":{}},"docs":{}}},"docs":{}},"docs":{}}},"docs":{}}}}},"docs":{}}}}}},"docs":{}}}},"docs":{}},"docs":{}}},"docs":{}}}},"docs":{}}}},"docs":{}},"docs":{}}},"docs":{}},"docs":{}}},"docs":{}}}},"docs":{}},"docs":{}}}},"docs":{}}},"docs":{}}}}},"docs":{}}}}}},"docs":{}}}}},"docs":{}}}}}},"docs":{}}},"'":{"docs":{},"i":{"docs":{},"f":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}},"(":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"e":{"docs":{},"g":{"docs":{},"e":{"docs":{},"r":{"docs":{},")":{"docs":{"content.html":{"ref":"content.html","tf":0.010582010582010581}}}}}}}}}}},"/":{"docs":{},"/":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"=":{"docs":{},"=":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"a":{"docs":{},"r":{"docs":{},"g":{"docs":{},"v":{"docs":{},"[":{"1":{"docs":{},"]":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"docs":{}}}}},"：":{"docs":{},"无":{"docs":{},"死":{"docs":{},"锁":{"docs":{},"，":{"docs":{},"即":{"docs":{},"便":{"docs":{},"持":{"docs":{},"有":{"docs":{},"锁":{"docs":{},"的":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"崩":{"docs":{},"溃":{"docs":{},"，":{"docs":{},"锁":{"docs":{},"仍":{"docs":{},"然":{"docs":{},"可":{"docs":{},"以":{"docs":{},"释":{"docs":{},"放":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}},"b":{"docs":{},"a":{"docs":{},"s":{"docs":{},"e":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}},"：":{"docs":{},"容":{"docs":{},"错":{"docs":{},"性":{"docs":{},"，":{"docs":{},"只":{"docs":{},"要":{"docs":{},"大":{"docs":{},"部":{"docs":{},"分":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}},"d":{"docs":{},"b":{"docs":{},"、":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"、":{"docs":{},"z":{"docs":{},"o":{"docs":{},"o":{"docs":{},"k":{"docs":{},"e":{"docs":{},"e":{"docs":{},"p":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}},"e":{"docs":{},"l":{"docs":{"content.html":{"ref":"content.html","tf":0.037037037037037035}}}},"f":{"docs":{},"e":{"docs":{},"e":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}},"e":{"docs":{},"n":{"docs":{},"d":{"docs":{},"'":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}},"v":{"docs":{},"a":{"docs":{},"l":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}},"x":{"docs":{},"i":{"docs":{},"s":{"docs":{},"t":{"docs":{},",":{"docs":{},"即":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}},"p":{"docs":{},"i":{"docs":{},"r":{"docs":{"content.html":{"ref":"content.html","tf":0.021164021164021163}}}}}}},"f":{"docs":{},"a":{"docs":{},"i":{"docs":{},"l":{"docs":{},"o":{"docs":{},"v":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}},"h":{"docs":{},"t":{"docs":{},"t":{"docs":{},"p":{"docs":{},"s":{"docs":{},":":{"docs":{},"/":{"docs":{},"/":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},".":{"docs":{},"i":{"docs":{},"o":{"docs":{},"/":{"docs":{},"t":{"docs":{},"o":{"docs":{},"p":{"docs":{},"i":{"docs":{},"c":{"docs":{},"s":{"docs":{},"/":{"docs":{},"d":{"docs":{},"i":{"docs":{},"s":{"docs":{},"t":{"docs":{},"l":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}},"t":{"docs":{},"r":{"docs":{},"a":{"docs":{},"n":{"docs":{},"s":{"docs":{},"a":{"docs":{},"c":{"docs":{},"t":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}},"w":{"docs":{},"w":{"docs":{},"w":{"docs":{},".":{"docs":{},"x":{"docs":{},"i":{"docs":{},"l":{"docs":{},"i":{"docs":{},"d":{"docs":{},"o":{"docs":{},"u":{"docs":{},".":{"docs":{},"c":{"docs":{},"o":{"docs":{},"m":{"docs":{},"/":{"2":{"0":{"1":{"7":{"docs":{},"/":{"1":{"0":{"docs":{},"/":{"2":{"9":{"docs":{},"/":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}},"docs":{}},"docs":{}}},"docs":{}},"docs":{}}},"docs":{}},"docs":{}},"docs":{}},"docs":{}}}}}}}}}}}}}}}}}}}}}}}}},"j":{"docs":{},"v":{"docs":{},"m":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}},"l":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{},"_":{"docs":{},"k":{"docs":{},"e":{"docs":{},"y":{"docs":{"content.html":{"ref":"content.html","tf":0.05291005291005291}}}}}}}}},"u":{"docs":{},"a":{"docs":{"content.html":{"ref":"content.html","tf":0.026455026455026454}}}}},"m":{"docs":{},"a":{"docs":{},"s":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{"content.html":{"ref":"content.html","tf":0.010582010582010581}}}}}}}},"n":{"docs":{},"x":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}},"、":{"docs":{},"e":{"docs":{},"x":{"docs":{},"p":{"docs":{},"i":{"docs":{},"r":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}},"o":{"docs":{},"k":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"p":{"docs":{},"x":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{"content.html":{"ref":"content.html","tf":0.047619047619047616}},"s":{"docs":{},".":{"docs":{},"c":{"docs":{},"a":{"docs":{},"l":{"docs":{},"l":{"docs":{},"(":{"docs":{},"\"":{"docs":{},"d":{"docs":{},"e":{"docs":{},"l":{"docs":{},"\"":{"docs":{},",":{"docs":{},"k":{"docs":{},"e":{"docs":{},"y":{"docs":{},"s":{"docs":{},"[":{"1":{"docs":{},"]":{"docs":{},")":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}},"docs":{}}}}}}}}}}},"g":{"docs":{},"e":{"docs":{},"t":{"docs":{},"\"":{"docs":{},",":{"docs":{},"k":{"docs":{},"e":{"docs":{},"y":{"docs":{},"s":{"docs":{},"[":{"1":{"docs":{},"]":{"docs":{},")":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}},"docs":{}}}}}}}}}}}}}}}}}}}},"l":{"docs":{},"o":{"docs":{},"c":{"docs":{},"k":{"docs":{"content.html":{"ref":"content.html","tf":0.010582010582010581}},"。":{"docs":{},"对":{"docs":{},"于":{"docs":{},"使":{"docs":{},"用":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"的":{"docs":{},"目":{"docs":{},"的":{"docs":{},"可":{"docs":{},"以":{"docs":{},"参":{"docs":{},"考":{"docs":{},"这":{"docs":{},"篇":{"docs":{},"文":{"docs":{},"章":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}},"s":{"docs":{},"s":{"docs":{},"i":{"docs":{},"o":{"docs":{},"n":{"docs":{},"；":{"docs":{},"问":{"docs":{},"题":{"docs":{},"（":{"3":{"docs":{},"）":{"docs":{},"的":{"docs":{},"解":{"docs":{},"决":{"docs":{},"方":{"docs":{},"案":{"docs":{},"可":{"docs":{},"以":{"docs":{},"参":{"docs":{},"考":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}},"docs":{}}}}}}}}}}},"q":{"docs":{},"u":{"docs":{},"e":{"docs":{},"s":{"docs":{},"t":{"docs":{},"_":{"docs":{},"i":{"docs":{},"d":{"docs":{},"；":{"docs":{},"n":{"docs":{},"x":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}},"t":{"docs":{},"u":{"docs":{},"r":{"docs":{},"n":{"docs":{"content.html":{"ref":"content.html","tf":0.010582010582010581}}}}}}}},"s":{"docs":{},"e":{"docs":{},"n":{"docs":{},"t":{"docs":{},"i":{"docs":{},"n":{"docs":{},"e":{"docs":{},"l":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}},"t":{"docs":{"content.html":{"ref":"content.html","tf":0.021164021164021163}},"n":{"docs":{},"x":{"docs":{"content.html":{"ref":"content.html","tf":0.015873015873015872}}}}}},"l":{"docs":{},"a":{"docs":{},"v":{"docs":{},"e":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}},"t":{"docs":{},"r":{"docs":{},"a":{"docs":{},"n":{"docs":{},"s":{"docs":{},"c":{"docs":{},"a":{"docs":{},"t":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}},"u":{"docs":{},"n":{"docs":{},"i":{"docs":{},"q":{"docs":{},"u":{"docs":{},"e":{"docs":{},"_":{"docs":{},"v":{"docs":{},"a":{"docs":{},"l":{"docs":{},"u":{"docs":{"content.html":{"ref":"content.html","tf":0.026455026455026454}},"e":{"docs":{},"，":{"docs":{},"在":{"docs":{},"解":{"docs":{},"锁":{"docs":{},"之":{"docs":{},"前":{"docs":{},"先":{"docs":{},"判":{"docs":{},"断":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}},"v":{"docs":{},"a":{"docs":{},"l":{"docs":{},"u":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}},"上":{"docs":{},"述":{"docs":{},"代":{"docs":{},"码":{"docs":{},"是":{"docs":{},"通":{"docs":{},"过":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}},"操":{"docs":{},"作":{"docs":{},"其":{"docs":{},"实":{"docs":{},"忽":{"docs":{},"略":{"docs":{},"了":{"docs":{},"一":{"docs":{},"个":{"docs":{},"问":{"docs":{},"题":{"docs":{},"，":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}},"罗":{"docs":{},"列":{"docs":{},"的":{"docs":{},"三":{"docs":{},"个":{"docs":{},"问":{"docs":{},"题":{"docs":{},"，":{"docs":{},"生":{"docs":{},"产":{"docs":{},"环":{"docs":{},"境":{"docs":{},"都":{"docs":{},"是":{"docs":{},"小":{"docs":{},"概":{"docs":{},"率":{"docs":{},"场":{"docs":{},"景":{"docs":{},"，":{"docs":{},"但":{"docs":{},"是":{"docs":{},"为":{"docs":{},"了":{"docs":{},"避":{"docs":{},"免":{"docs":{},"，":{"docs":{},"问":{"docs":{},"题":{"docs":{},"（":{"1":{"docs":{},"）":{"docs":{},"建":{"docs":{},"议":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"不":{"docs":{},"要":{"docs":{},"应":{"docs":{},"用":{"docs":{},"于":{"docs":{},"时":{"docs":{},"间":{"docs":{},"较":{"docs":{},"长":{"docs":{},"的":{"docs":{},"接":{"docs":{},"口":{"docs":{},"或":{"docs":{},"任":{"docs":{},"务":{"docs":{},"；":{"docs":{},"问":{"docs":{},"题":{"docs":{},"（":{"2":{"docs":{},"）":{"docs":{},"一":{"docs":{},"般":{"docs":{},"业":{"docs":{},"务":{"docs":{},"使":{"docs":{},"用":{"docs":{},"到":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"都":{"docs":{},"不":{"docs":{},"会":{"docs":{},"用":{"docs":{},"到":{"docs":{},"重":{"docs":{},"入":{"docs":{},"性":{"docs":{},"，":{"docs":{},"如":{"docs":{},"需":{"docs":{},"用":{"docs":{},"到":{"docs":{},"，":{"docs":{},"可":{"docs":{},"自":{"docs":{},"行":{"docs":{},"封":{"docs":{},"装":{"docs":{},"，":{"docs":{},"也":{"docs":{},"可":{"docs":{},"以":{"docs":{},"引":{"docs":{},"用":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"docs":{}}}}}}}}}}}}}}}}}}}}}}}}}}}},"docs":{}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"不":{"docs":{},"存":{"docs":{},"在":{"docs":{},"时":{"docs":{},"，":{"docs":{},"我":{"docs":{},"们":{"docs":{},"进":{"docs":{},"行":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}},"支":{"docs":{},"持":{"docs":{},"重":{"docs":{},"入":{"docs":{},"性":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}},"之":{"docs":{},"前":{"docs":{},"，":{"docs":{},"m":{"docs":{},"a":{"docs":{},"s":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}},"间":{"docs":{},"系":{"docs":{},"统":{"docs":{},"出":{"docs":{},"现":{"docs":{},"异":{"docs":{},"常":{"docs":{},"或":{"docs":{},"者":{"docs":{},"奔":{"docs":{},"溃":{"docs":{},"了":{"docs":{},"，":{"docs":{},"也":{"docs":{},"会":{"docs":{},"导":{"docs":{},"致":{"docs":{},"死":{"docs":{},"锁":{"docs":{},"。":{"docs":{},"或":{"docs":{},"许":{"docs":{},"会":{"docs":{},"有":{"docs":{},"人":{"docs":{},"想":{"docs":{},"到":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"事":{"docs":{},"务":{"docs":{},"不":{"docs":{},"确":{"docs":{},"保":{"docs":{},"原":{"docs":{},"子":{"docs":{},"性":{"docs":{},"（":{"docs":{},"参":{"docs":{},"考":{"docs":{},"：":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}},"值":{"docs":{},"一":{"docs":{},"样":{"docs":{},"，":{"docs":{},"则":{"docs":{},"删":{"docs":{},"除":{"docs":{},"锁":{"docs":{},"，":{"docs":{},"这":{"docs":{},"样":{"docs":{},"能":{"docs":{},"避":{"docs":{},"免":{"docs":{},"其":{"docs":{},"他":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"删":{"docs":{},"除":{"docs":{},"该":{"docs":{},"锁":{"docs":{},"。":{"docs":{},"那":{"docs":{},"为":{"docs":{},"什":{"docs":{},"么":{"docs":{},"用":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"的":{"docs":{},"实":{"docs":{},"现":{"docs":{"content.html":{"ref":"content.html","tf":10}}}}},"解":{"docs":{},"决":{"docs":{},"的":{"docs":{},"场":{"docs":{},"景":{"docs":{},"就":{"docs":{},"是":{"docs":{},"有":{"docs":{},"点":{"docs":{},"像":{"docs":{},"我":{"docs":{},"们":{"docs":{},"平":{"docs":{},"常":{"docs":{},"玩":{"docs":{},"的":{"docs":{},"“":{"docs":{},"抢":{"docs":{},"椅":{"docs":{},"子":{"docs":{},"”":{"docs":{},"游":{"docs":{},"戏":{"docs":{},"，":{"docs":{},"当":{"docs":{},"有":{"docs":{},"人":{"docs":{},"占":{"docs":{},"用":{"docs":{},"时":{"docs":{},"，":{"docs":{},"其":{"docs":{},"他":{"docs":{},"人":{"docs":{},"只":{"docs":{},"能":{"docs":{},"放":{"docs":{},"弃":{"docs":{},"或":{"docs":{},"者":{"docs":{},"稍":{"docs":{},"后":{"docs":{},"重":{"docs":{},"试":{"docs":{},"。":{"docs":{},"一":{"docs":{},"般":{"docs":{},"获":{"docs":{},"取":{"docs":{},"锁":{"docs":{},"可":{"docs":{},"以":{"docs":{},"用":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"即":{"docs":{},"便":{"docs":{},"按":{"docs":{},"照":{"docs":{},"上":{"docs":{},"述":{"docs":{},"要":{"docs":{},"求":{"docs":{},"实":{"docs":{},"现":{"docs":{},"了":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"，":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"也":{"docs":{},"不":{"docs":{},"是":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}},"参":{"docs":{},"考":{"docs":{},"阅":{"docs":{},"读":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}},"可":{"docs":{},"以":{"docs":{},"理":{"docs":{},"解":{"docs":{},"为":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}},"重":{"docs":{},"入":{"docs":{},"性":{"docs":{},"，":{"docs":{},"是":{"docs":{},"指":{"docs":{},"线":{"docs":{},"程":{"docs":{},"在":{"docs":{},"持":{"docs":{},"有":{"docs":{},"锁":{"docs":{},"的":{"docs":{},"情":{"docs":{},"况":{"docs":{},"下":{"docs":{},"再":{"docs":{},"次":{"docs":{},"请":{"docs":{},"求":{"docs":{},"该":{"docs":{},"锁":{"docs":{},"，":{"docs":{},"如":{"docs":{},"果":{"docs":{},"一":{"docs":{},"个":{"docs":{},"锁":{"docs":{},"支":{"docs":{},"持":{"docs":{},"同":{"docs":{},"一":{"docs":{},"个":{"docs":{},"线":{"docs":{},"程":{"docs":{},"多":{"docs":{},"次":{"docs":{},"添":{"docs":{},"加":{"docs":{},"锁":{"docs":{},"，":{"docs":{},"那":{"docs":{},"么":{"docs":{},"这":{"docs":{},"个":{"docs":{},"锁":{"docs":{},"就":{"docs":{},"是":{"docs":{},"支":{"docs":{},"持":{"docs":{},"重":{"docs":{},"入":{"docs":{},"性":{"docs":{},"的":{"docs":{},"。":{"docs":{},"单":{"docs":{},"纯":{"docs":{},"的":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"命":{"docs":{},"令":{"docs":{},"不":{"docs":{},"支":{"docs":{},"持":{"docs":{},"，":{"docs":{},"需":{"docs":{},"要":{"docs":{},"自":{"docs":{},"己":{"docs":{},"进":{"docs":{},"行":{"docs":{},"封":{"docs":{},"装":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}},"同":{"docs":{},"时":{"docs":{},"设":{"docs":{},"置":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}},"直":{"docs":{},"接":{"docs":{},"操":{"docs":{},"作":{"docs":{},"，":{"docs":{},"这":{"docs":{},"样":{"docs":{},"就":{"docs":{},"会":{"docs":{},"导":{"docs":{},"致":{"docs":{},"任":{"docs":{},"意":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"都":{"docs":{},"可":{"docs":{},"以":{"docs":{},"进":{"docs":{},"行":{"docs":{},"解":{"docs":{},"锁":{"docs":{},"。":{"docs":{},"为":{"docs":{},"了":{"docs":{},"安":{"docs":{},"全":{"docs":{},"起":{"docs":{},"见":{"docs":{},"，":{"docs":{},"应":{"docs":{},"该":{"docs":{},"只":{"docs":{},"有":{"docs":{},"加":{"docs":{},"锁":{"docs":{},"的":{"docs":{},"拥":{"docs":{},"有":{"docs":{},"者":{"docs":{},"能":{"docs":{},"解":{"docs":{},"锁":{"docs":{},"，":{"docs":{},"所":{"docs":{},"以":{"docs":{},"参":{"docs":{},"考":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"和":{"docs":{"content.html":{"ref":"content.html","tf":0.021164021164021163}}},"大":{"docs":{},"多":{"docs":{},"数":{"docs":{},"公":{"docs":{},"司":{"docs":{},"仅":{"docs":{},"仅":{"docs":{},"只":{"docs":{},"作":{"docs":{},"为":{"docs":{},"缓":{"docs":{},"存":{"docs":{},"，":{"docs":{},"不":{"docs":{},"作":{"docs":{},"为":{"docs":{},"持":{"docs":{},"久":{"docs":{},"化":{"docs":{},"工":{"docs":{},"具":{"docs":{},"。":{"docs":{},"对":{"docs":{},"于":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"存":{"docs":{},"在":{"docs":{},"的":{"docs":{},"问":{"docs":{},"题":{"docs":{},"总":{"docs":{},"结":{"docs":{},"如":{"docs":{},"下":{"docs":{},"：":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"如":{"docs":{},"果":{"docs":{},"获":{"docs":{},"取":{"docs":{},"锁":{"docs":{},"和":{"docs":{},"释":{"docs":{},"放":{"docs":{},"锁":{"docs":{},"之":{"docs":{},"间":{"docs":{},"，":{"docs":{},"接":{"docs":{},"口":{"docs":{},"出":{"docs":{},"现":{"docs":{},"超":{"docs":{},"时":{"docs":{},"，":{"docs":{},"以":{"docs":{},"至":{"docs":{},"于":{"docs":{},"超":{"docs":{},"出":{"docs":{},"了":{"docs":{},"锁":{"docs":{},"的":{"docs":{},"过":{"docs":{},"期":{"docs":{},"时":{"docs":{},"间":{"docs":{},"，":{"docs":{},"会":{"docs":{},"导":{"docs":{},"致":{"docs":{},"并":{"docs":{},"发":{"docs":{},"执":{"docs":{},"行":{"docs":{},"临":{"docs":{},"界":{"docs":{},"区":{"docs":{},"程":{"docs":{},"序":{"docs":{},"。":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"安":{"docs":{},"全":{"docs":{},"属":{"docs":{},"性":{"docs":{},"：":{"docs":{},"独":{"docs":{},"占":{"docs":{},"（":{"docs":{},"相":{"docs":{},"互":{"docs":{},"排":{"docs":{},"斥":{"docs":{},"）":{"docs":{},"，":{"docs":{},"在":{"docs":{},"任":{"docs":{},"意":{"docs":{},"一":{"docs":{},"个":{"docs":{},"时":{"docs":{},"刻":{"docs":{},"，":{"docs":{},"最":{"docs":{},"多":{"docs":{},"只":{"docs":{},"有":{"docs":{},"一":{"docs":{},"个":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"持":{"docs":{},"有":{"docs":{},"该":{"docs":{},"锁":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"完":{"docs":{},"美":{"docs":{},"的":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"么":{"docs":{},"？":{"docs":{},"，":{"docs":{},"对":{"docs":{},"于":{"docs":{},"严":{"docs":{},"格":{"docs":{},"要":{"docs":{},"求":{"docs":{},"的":{"docs":{},"场":{"docs":{},"景":{"docs":{},"（":{"docs":{},"比":{"docs":{},"如":{"docs":{},"订":{"docs":{},"单":{"docs":{},"、":{"docs":{},"金":{"docs":{},"额":{"docs":{},"）":{"docs":{},"，":{"docs":{},"即":{"docs":{},"便":{"docs":{},"使":{"docs":{},"用":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"，":{"docs":{},"也":{"docs":{},"不":{"docs":{},"能":{"docs":{},"保":{"docs":{},"证":{"docs":{},"锁":{"docs":{},"的":{"docs":{},"正":{"docs":{},"确":{"docs":{},"性":{"docs":{},"，":{"docs":{},"其":{"docs":{},"他":{"docs":{},"非":{"docs":{},"严":{"docs":{},"格":{"docs":{},"场":{"docs":{},"景":{"docs":{},"，":{"docs":{},"可":{"docs":{},"以":{"docs":{},"参":{"docs":{},"考":{"docs":{},"自":{"docs":{},"己":{"docs":{},"的":{"docs":{},"业":{"docs":{},"务":{"docs":{},"是":{"docs":{},"否":{"docs":{},"能":{"docs":{},"容":{"docs":{},"忍":{"docs":{},"这":{"docs":{},"种":{"docs":{},"小":{"docs":{},"概":{"docs":{},"率":{"docs":{},"事":{"docs":{},"件":{"docs":{},"了":{"docs":{},"。":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"宕":{"docs":{},"机":{"docs":{},"了":{"docs":{},"，":{"docs":{},"s":{"docs":{},"l":{"docs":{},"a":{"docs":{},"v":{"docs":{},"e":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}},"实":{"docs":{},"现":{"docs":{},"一":{"docs":{},"个":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"最":{"docs":{},"基":{"docs":{},"本":{"docs":{},"的":{"docs":{},"需":{"docs":{},"要":{"docs":{},"满":{"docs":{},"足":{"docs":{},"三":{"docs":{},"点":{"docs":{},"：":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"的":{"docs":{},"方":{"docs":{},"式":{"docs":{},"大":{"docs":{},"致":{"docs":{},"有":{"docs":{},"三":{"docs":{},"种":{"docs":{},"，":{"docs":{},"分":{"docs":{},"别":{"docs":{},"是":{"docs":{},"基":{"docs":{},"于":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"从":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}},"对":{"docs":{},"应":{"docs":{},"的":{"docs":{},"值":{"docs":{},"，":{"docs":{},"如":{"docs":{},"果":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}},"将":{"docs":{},"锁":{"docs":{},"同":{"docs":{},"步":{"docs":{},"到":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}},"已":{"docs":{},"经":{"docs":{},"存":{"docs":{},"在":{"docs":{},"，":{"docs":{},"不":{"docs":{},"做":{"docs":{},"任":{"docs":{},"何":{"docs":{},"操":{"docs":{},"作":{"docs":{},"；":{"docs":{},"p":{"docs":{},"x":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}},"当":{"docs":{},"业":{"docs":{},"务":{"docs":{},"发":{"docs":{},"展":{"docs":{},"到":{"docs":{},"一":{"docs":{},"定":{"docs":{},"程":{"docs":{},"度":{"docs":{},"的":{"docs":{},"时":{"docs":{},"候":{"docs":{},"，":{"docs":{},"集":{"docs":{},"群":{"docs":{},"环":{"docs":{},"境":{"docs":{},"搭":{"docs":{},"建":{"docs":{},"服":{"docs":{},"务":{"docs":{},"就":{"docs":{},"在":{"docs":{},"所":{"docs":{},"难":{"docs":{},"免":{"docs":{},"，":{"docs":{},"集":{"docs":{},"群":{"docs":{},"环":{"docs":{},"境":{"docs":{},"不":{"docs":{},"同":{"docs":{},"于":{"docs":{},"单":{"docs":{},"机":{"docs":{},"环":{"docs":{},"境":{"docs":{},"，":{"docs":{},"单":{"docs":{},"纯":{"docs":{},"的":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"指":{"docs":{},"令":{"docs":{},"删":{"docs":{},"除":{"docs":{},"就":{"docs":{},"行":{"docs":{},"。":{"docs":{},"但":{"docs":{},"是":{"docs":{},"有":{"docs":{},"个":{"docs":{},"问":{"docs":{},"题":{"docs":{},"，":{"docs":{},"如":{"docs":{},"果":{"docs":{},"程":{"docs":{},"序":{"docs":{},"执":{"docs":{},"行":{"docs":{},"到":{"docs":{},"中":{"docs":{},"间":{"docs":{},"系":{"docs":{},"统":{"docs":{},"出":{"docs":{},"现":{"docs":{},"异":{"docs":{},"常":{"docs":{},"或":{"docs":{},"者":{"docs":{},"奔":{"docs":{},"溃":{"docs":{},"了":{"docs":{},"，":{"docs":{},"可":{"docs":{},"能":{"docs":{},"会":{"docs":{},"导":{"docs":{},"致":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"没":{"docs":{},"被":{"docs":{},"调":{"docs":{},"用":{"docs":{},"，":{"docs":{},"这":{"docs":{},"样":{"docs":{},"就":{"docs":{},"会":{"docs":{},"出":{"docs":{},"现":{"docs":{},"死":{"docs":{},"锁":{"docs":{},"问":{"docs":{},"题":{"docs":{},"。":{"docs":{},"于":{"docs":{},"是":{"docs":{},"我":{"docs":{},"们":{"docs":{},"想":{"docs":{},"到":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}},"的":{"docs":{},"时":{"docs":{},"候":{"docs":{},"这":{"docs":{},"个":{"docs":{},"锁":{"docs":{},"已":{"docs":{},"经":{"docs":{},"自":{"docs":{},"动":{"docs":{},"失":{"docs":{},"效":{"docs":{},"了":{"docs":{},"（":{"docs":{},"接":{"docs":{},"口":{"docs":{},"超":{"docs":{},"时":{"docs":{},"情":{"docs":{},"况":{"docs":{},"下":{"docs":{},"可":{"docs":{},"能":{"docs":{},"会":{"docs":{},"出":{"docs":{},"现":{"docs":{},"）":{"docs":{},"，":{"docs":{},"不":{"docs":{},"是":{"docs":{},"该":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"锁":{"docs":{},"持":{"docs":{},"有":{"docs":{},"的":{"docs":{},"锁":{"docs":{},"了":{"docs":{},"，":{"docs":{},"所":{"docs":{},"以":{"docs":{},"为":{"docs":{},"了":{"docs":{},"安":{"docs":{},"全":{"docs":{},"起":{"docs":{},"见":{"docs":{},"，":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"，":{"docs":{},"只":{"docs":{},"允":{"docs":{},"许":{"docs":{},"被":{"docs":{},"一":{"docs":{},"个":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"占":{"docs":{},"用":{"docs":{},"，":{"docs":{},"想":{"docs":{},"离":{"docs":{},"开":{"docs":{},"时":{"docs":{},"，":{"docs":{},"只":{"docs":{},"需":{"docs":{},"要":{"docs":{},"调":{"docs":{},"用":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}},"接":{"docs":{},"口":{"docs":{},"超":{"docs":{},"时":{"docs":{},"问":{"docs":{},"题":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}},"操":{"docs":{},"作":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}},"，":{"docs":{},"若":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}},"是":{"docs":{},"一":{"docs":{},"条":{"docs":{},"指":{"docs":{},"令":{"docs":{},"，":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}},"两":{"docs":{},"个":{"docs":{},"指":{"docs":{},"令":{"docs":{},"，":{"docs":{},"也":{"docs":{},"不":{"docs":{},"是":{"docs":{},"原":{"docs":{},"子":{"docs":{},"性":{"docs":{},"的":{"docs":{},"，":{"docs":{},"所":{"docs":{},"以":{"docs":{},"可":{"docs":{},"能":{"docs":{},"会":{"docs":{},"出":{"docs":{},"现":{"docs":{},"调":{"docs":{},"用":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}},"在":{"docs":{},"s":{"docs":{},"e":{"docs":{},"t":{"docs":{},"n":{"docs":{},"x":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}},"否":{"docs":{},"和":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"添":{"docs":{},"加":{"docs":{},"锁":{"docs":{},"的":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}},"相":{"docs":{},"等":{"docs":{},"，":{"docs":{},"相":{"docs":{},"等":{"docs":{},"则":{"docs":{},"执":{"docs":{},"行":{"docs":{},"如":{"docs":{},"下":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}},"服":{"docs":{},"务":{"docs":{},"器":{"docs":{},"会":{"docs":{},"单":{"docs":{},"线":{"docs":{},"程":{"docs":{},"原":{"docs":{},"子":{"docs":{},"性":{"docs":{},"的":{"docs":{},"执":{"docs":{},"行":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}},"保":{"docs":{},"证":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}},"概":{"docs":{},"述":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"活":{"docs":{},"性":{"docs":{"content.html":{"ref":"content.html","tf":0.010582010582010581}}}},"添":{"docs":{},"加":{"docs":{},"过":{"docs":{},"期":{"docs":{},"时":{"docs":{},"间":{"docs":{},"，":{"docs":{},"具":{"docs":{},"体":{"docs":{},"时":{"docs":{},"间":{"docs":{},"就":{"docs":{},"是":{"docs":{},"后":{"docs":{},"面":{"docs":{},"的":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}},"版":{"docs":{},"本":{"docs":{},"开":{"docs":{},"始":{"docs":{},"支":{"docs":{},"持":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}},"的":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}},"事":{"docs":{},"务":{"docs":{},"，":{"docs":{},"但":{"docs":{},"是":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}},"值":{"docs":{},"和":{"docs":{},"获":{"docs":{},"取":{"docs":{},"锁":{"docs":{},"设":{"docs":{},"置":{"docs":{},"的":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}},"是":{"docs":{},"否":{"docs":{},"相":{"docs":{},"等":{"docs":{},"，":{"docs":{},"如":{"docs":{},"果":{"docs":{},"相":{"docs":{},"等":{"docs":{},"，":{"docs":{},"才":{"docs":{},"能":{"docs":{},"解":{"docs":{},"锁":{"docs":{},"，":{"docs":{},"于":{"docs":{},"是":{"docs":{},"就":{"docs":{},"有":{"docs":{},"了":{"docs":{},"下":{"docs":{},"面":{"docs":{},"的":{"docs":{},"命":{"docs":{},"令":{"docs":{},"行":{"docs":{},"解":{"docs":{},"锁":{"docs":{},"：":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"意":{"docs":{},"思":{"docs":{},"是":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}},"时":{"docs":{},"候":{"docs":{},"给":{"docs":{},"命":{"docs":{},"令":{"docs":{},"加":{"docs":{},"一":{"docs":{},"个":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}},"程":{"docs":{},"序":{"docs":{},"里":{"docs":{},"面":{"docs":{},"判":{"docs":{},"断":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}},"等":{"docs":{},"参":{"docs":{},"数":{"docs":{},"，":{"docs":{},"具":{"docs":{},"体":{"docs":{},"代":{"docs":{},"码":{"docs":{},"如":{"docs":{},"下":{"docs":{},"：":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}},"给":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}},"脚":{"docs":{},"本":{"docs":{},"在":{"docs":{},"处":{"docs":{},"理":{"docs":{},"的":{"docs":{},"过":{"docs":{},"程":{"docs":{},"中":{"docs":{},"不":{"docs":{},"受":{"docs":{},"外":{"docs":{},"界":{"docs":{},"打":{"docs":{},"扰":{"docs":{},"而":{"docs":{},"中":{"docs":{},"断":{"docs":{},"。":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}},"实":{"docs":{},"现":{"docs":{},"的":{"docs":{},"，":{"docs":{},"先":{"docs":{},"获":{"docs":{},"取":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}},"？":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}},"该":{"docs":{},"应":{"docs":{},"用":{"docs":{},"了":{"docs":{},"，":{"docs":{},"代":{"docs":{},"码":{"docs":{},"如":{"docs":{},"下":{"docs":{},"：":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}},"，":{"docs":{},"保":{"docs":{},"证":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}},"节":{"docs":{},"点":{"docs":{},"获":{"docs":{},"取":{"docs":{},"锁":{"docs":{},"，":{"docs":{},"m":{"docs":{},"a":{"docs":{},"s":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}},"被":{"docs":{},"晋":{"docs":{},"级":{"docs":{},"为":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}},"都":{"docs":{},"活":{"docs":{},"着":{"docs":{},"，":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"仍":{"docs":{},"然":{"docs":{},"可":{"docs":{},"以":{"docs":{},"获":{"docs":{},"取":{"docs":{},"和":{"docs":{},"释":{"docs":{},"放":{"docs":{},"锁":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}},"，":{"docs":{},"此":{"docs":{},"时":{"docs":{},"也":{"docs":{},"会":{"docs":{},"出":{"docs":{},"现":{"docs":{},"并":{"docs":{},"发":{"docs":{},"执":{"docs":{},"行":{"docs":{},"临":{"docs":{},"界":{"docs":{},"区":{"docs":{},"程":{"docs":{},"序":{"docs":{},"。":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}},"获":{"docs":{},"取":{"docs":{},"锁":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}},"过":{"docs":{},"期":{"docs":{},"时":{"docs":{},"间":{"docs":{},"，":{"docs":{},"但":{"docs":{},"是":{"docs":{},"这":{"docs":{},"种":{"docs":{},"也":{"docs":{},"容":{"docs":{},"易":{"docs":{},"出":{"docs":{},"现":{"docs":{},"问":{"docs":{},"题":{"docs":{},"，":{"docs":{},"s":{"docs":{},"e":{"docs":{},"t":{"docs":{},"n":{"docs":{},"x":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}},"这":{"docs":{},"三":{"docs":{},"种":{"docs":{},"。":{"docs":{},"下":{"docs":{},"面":{"docs":{},"将":{"docs":{},"讲":{"docs":{},"解":{"docs":{},"这":{"docs":{},"三":{"docs":{},"种":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"的":{"docs":{},"具":{"docs":{},"体":{"docs":{},"实":{"docs":{},"现":{"docs":{},"方":{"docs":{},"式":{"docs":{},"。":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}},"个":{"docs":{},"值":{"docs":{},"在":{"docs":{},"所":{"docs":{},"有":{"docs":{},"获":{"docs":{},"取":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"必":{"docs":{},"须":{"docs":{},"是":{"docs":{},"唯":{"docs":{},"一":{"docs":{},"的":{"docs":{},"，":{"docs":{},"唯":{"docs":{},"一":{"docs":{},"性":{"docs":{},"是":{"docs":{},"为":{"docs":{},"了":{"docs":{},"后":{"docs":{},"面":{"docs":{},"释":{"docs":{},"放":{"docs":{},"锁":{"docs":{},"的":{"docs":{},"时":{"docs":{},"候":{"docs":{},"避":{"docs":{},"免":{"docs":{},"其":{"docs":{},"他":{"docs":{},"客":{"docs":{},"户":{"docs":{},"端":{"docs":{},"释":{"docs":{},"放":{"docs":{},"该":{"docs":{},"锁":{"docs":{},"，":{"docs":{},"u":{"docs":{},"n":{"docs":{},"i":{"docs":{},"q":{"docs":{},"u":{"docs":{},"e":{"docs":{},"_":{"docs":{},"v":{"docs":{},"a":{"docs":{},"l":{"docs":{},"u":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"命":{"docs":{},"令":{"docs":{},"行":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}},"释":{"docs":{},"放":{"docs":{},"锁":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}},"大":{"docs":{},"家":{"docs":{},"首":{"docs":{},"先":{"docs":{},"会":{"docs":{},"想":{"docs":{},"到":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}},"里":{"docs":{},"面":{"docs":{},"说":{"docs":{},"的":{"docs":{},"添":{"docs":{},"加":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}},"锁":{"docs":{},"不":{"docs":{},"再":{"docs":{},"有":{"docs":{},"意":{"docs":{},"义":{"docs":{},"，":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"自":{"docs":{},"然":{"docs":{},"应":{"docs":{},"用":{"docs":{},"而":{"docs":{},"生":{"docs":{},"，":{"docs":{},"分":{"docs":{},"布":{"docs":{},"式":{"docs":{},"锁":{"docs":{},"可":{"docs":{},"以":{"docs":{},"有":{"docs":{},"效":{"docs":{},"解":{"docs":{},"决":{"docs":{},"程":{"docs":{},"序":{"docs":{},"的":{"docs":{},"并":{"docs":{},"发":{"docs":{},"执":{"docs":{},"行":{"docs":{},"。":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"的":{"docs":{},"实":{"docs":{},"现":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"要":{"docs":{},"求":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}},"问":{"docs":{},"题":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}},"集":{"docs":{},"群":{"docs":{},"主":{"docs":{},"从":{"docs":{},"发":{"docs":{},"生":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}},"靠":{"docs":{},"谱":{"docs":{},"的":{"docs":{},"，":{"docs":{},"r":{"docs":{},"e":{"docs":{},"d":{"docs":{},"i":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}}}},"）":{"docs":{},"。":{"docs":{},"但":{"docs":{},"是":{"docs":{},"从":{"docs":{"content.html":{"ref":"content.html","tf":0.005291005291005291}}}}}}}},"length":138},"corpusTokens":["\"7663e69f","%e5%ae%8c%e7%be%8e%e7%9a%84%e5%88%86%e5%b8%83%e5%bc%8f%e9%94%81%e4%b9%88%ef%bc%9f/","'if","(integer)","//","0","1","100%","127.0.0.1:6379>","2.8","2e9a2f16d478\"","30000","30000。","4c77","9153","==","argv[1]","a：无死锁，即便持有锁的客户端崩溃，锁仍然可以释放","base","b：容错性，只要大部分","db、redis、zookeep","del","dfee","end'","eval","exist,即","expir","failov","https://redis.io/topics/distlock","https://redis.io/topics/transact","https://www.xilidou.com/2017/10/29/redi","introduct","jvm","lock_key","lua","master","nx","nx、expir","ok","px","redi","redis.call(\"del\",keys[1])","redis.call(\"get\",keys[1])","redlock","redlock。对于使用分布式的目的可以参考这篇文章","redssion；问题（3）的解决方案可以参考","request_id；nx","return","sentinel","set","setnx","slave","transcat","unique_valu","unique_value，在解锁之前先判断","valu","上述代码是通过","上述操作其实忽略了一个问题，","上述罗列的三个问题，生产环境都是小概率场景，但是为了避免，问题（1）建议分布式锁不要应用于时间较长的接口或任务；问题（2）一般业务使用到分布式锁都不会用到重入性，如需用到，可自行封装，也可以引用","不存在时，我们进行","不支持重入性","之前，master","之间系统出现异常或者奔溃了，也会导致死锁。或许会有人想到","事务不确保原子性（参考：","值一样，则删除锁，这样能避免其他客户端删除该锁。那为什么用","分布式锁的实现","分布式锁解决的场景就是有点像我们平常玩的“抢椅子”游戏，当有人占用时，其他人只能放弃或者稍后重试。一般获取锁可以用","即便按照上述要求实现了分布式锁，分布式锁也不是","参考阅读","可以理解为","可重入性，是指线程在持有锁的情况下再次请求该锁，如果一个锁支持同一个线程多次添加锁，那么这个锁就是支持重入性的。单纯的","命令不支持，需要自己进行封装","命令同时设置","命令直接操作，这样就会导致任意客户端都可以进行解锁。为了安全起见，应该只有加锁的拥有者能解锁，所以参考","和","大多数公司仅仅只作为缓存，不作为持久化工具。对于分布式锁存在的问题总结如下：","如果获取锁和释放锁之间，接口出现超时，以至于超出了锁的过期时间，会导致并发执行临界区程序。","安全属性：独占（相互排斥），在任意一个时刻，最多只有一个客户端持有该锁","完美的分布式锁么？，对于严格要求的场景（比如订单、金额），即便使用分布式锁，也不能保证锁的正确性，其他非严格场景，可以参考自己的业务是否能容忍这种小概率事件了。","宕机了，slave","实现一个分布式锁最基本的需要满足三点：","实现分布式锁的方式大致有三种，分别是基于","客户端从","对应的值，如果","将锁同步到","已经存在，不做任何操作；px","当业务发展到一定程度的时候，集群环境搭建服务就在所难免，集群环境不同于单机环境，单纯的","指令删除就行。但是有个问题，如果程序执行到中间系统出现异常或者奔溃了，可能会导致","指令没被调用，这样就会出现死锁问题。于是我们想到","指令的时候这个锁已经自动失效了（接口超时情况下可能会出现），不是该客户端锁持有的锁了，所以为了安全起见，redi","指令，只允许被一个客户端占用，想离开时，只需要调用","接口超时问题","操作","操作，若","是一条指令，","是两个指令，也不是原子性的，所以可能会出现调用","是两个指令，在setnx","是否和客户端添加锁的","是否相等，相等则执行如下","服务器会单线程原子性的执行","服务器保证","概述","活性","添加过期时间，具体时间就是后面的","版本开始支持","的","的事务，但是","的值和获取锁设置的","的值是否相等，如果相等，才能解锁，于是就有了下面的命令行解锁：","的意思是","的时候给命令加一个","程序里面判断","等参数，具体代码如下：","给","脚本在处理的过程中不受外界打扰而中断。","脚本实现的，先获取","脚本实现？redi","脚本该应用了，代码如下：","脚本，保证","节点获取锁，master","节点被晋级为","节点都活着，客户端仍然可以获取和释放锁","节点，此时也会出现并发执行临界区程序。","获取锁","过期时间，但是这种也容易出现问题，setnx","这三种。下面将讲解这三种分布式锁的具体实现方式。","这个值在所有获取客户端必须是唯一的，唯一性是为了后面释放锁的时候避免其他客户端释放该锁，unique_valu","这个命令行","释放锁","释放锁大家首先会想到","里面说的添加","锁不再有意义，分布式锁自然应用而生，分布式锁可以有效解决程序的并发执行。","锁的实现","锁的要求","锁的问题","集群主从发生","靠谱的，redi","）。但是从"],"pipeline":["stopWordFilter","stemmer"]},"store":{"./":{"url":"./","title":"Introduction","keywords":"","body":"Introduction\n"},"content.html":{"url":"content.html","title":"分布式锁的实现","keywords":"","body":"概述\n当业务发展到一定程度的时候，集群环境搭建服务就在所难免，集群环境不同于单机环境，单纯的 JVM 锁不再有意义，分布式锁自然应用而生，分布式锁可以有效解决程序的并发执行。\n实现分布式锁的方式大致有三种，分别是基于 DB、Redis、Zookeeper 这三种。下面将讲解这三种分布式锁的具体实现方式。\nBase Redis\n锁的要求\n实现一个分布式锁最基本的需要满足三点：\n\n安全属性：独占（相互排斥），在任意一个时刻，最多只有一个客户端持有该锁\n活性 A：无死锁，即便持有锁的客户端崩溃，锁仍然可以释放\n活性 B：容错性，只要大部分 Redis 节点都活着，客户端仍然可以获取和释放锁\n\n锁的实现\n\n获取锁  \n\n分布式锁解决的场景就是有点像我们平常玩的“抢椅子”游戏，当有人占用时，其他人只能放弃或者稍后重试。一般获取锁可以用 SETNX 指令，只允许被一个客户端占用，想离开时，只需要调用 DEL 指令删除就行。但是有个问题，如果程序执行到中间系统出现异常或者奔溃了，可能会导致 DEL 指令没被调用，这样就会出现死锁问题。于是我们想到 SETNX 的时候给命令加一个 EXPIRE 过期时间，但是这种也容易出现问题，SETNX 和 EXPIRE 是两个指令，在SETNX 和 EXPIRE 之间系统出现异常或者奔溃了，也会导致死锁。或许会有人想到 Redis 的事务，但是 Redis 事务不确保原子性（参考： Redis Transcation ）。但是从 Redis 2.8 版本开始支持 SET 命令同时设置 NX、EXPIRE 等参数，具体代码如下：\n127.0.0.1:6379> SET lock_key unique_value NX PX 30000\nOK\n这个命令行 Redis 服务器保证 SETNX 和 EXPIRE 是一条指令， unique_value  这个值在所有获取客户端必须是唯一的，唯一性是为了后面释放锁的时候避免其他客户端释放该锁，unique_value 可以理解为 request_id；NX 的意思是 SET IF NOT EXIST,即 lock_key 不存在时，我们进行 SET 操作，若 lock_key 已经存在，不做任何操作；PX 给 lock_key 添加过期时间，具体时间就是后面的 30000。\n\n释放锁\n\n释放锁大家首先会想到 DEL 命令直接操作，这样就会导致任意客户端都可以进行解锁。为了安全起见，应该只有加锁的拥有者能解锁，所以参考 1 里面说的添加 unique_value，在解锁之前先判断 lock_key 的值是否相等，如果相等，才能解锁，于是就有了下面的命令行解锁：\n127.0.0.1:6379> GET lock_key\n\"7663e69f-dfee-4c77-9153-2e9a2f16d478\"\n// 程序里面判断 value 是否和客户端添加锁的 unique_value 是否相等，相等则执行如下 DEL 操作\n127.0.0.1:6379> DEL lock_key\n(integer) 1\n上述操作其实忽略了一个问题， GET 和 DEL 是两个指令，也不是原子性的，所以可能会出现调用 DEL 指令的时候这个锁已经自动失效了（接口超时情况下可能会出现），不是该客户端锁持有的锁了，所以为了安全起见，Redis 的 Lua 脚本该应用了，代码如下：\n127.0.0.1:6379> eval 'if redis.call(\"get\",KEYS[1]) == ARGV[1] then return redis.call(\"del\",KEYS[1]) else return 0 end' 1 lock_key unique_value\n(integer) 1\n上述代码是通过 Lua 脚本实现的，先获取 lock_key 对应的值，如果 lock_key 的值和获取锁设置的  unique_value 值一样，则删除锁，这样能避免其他客户端删除该锁。那为什么用 Lua 脚本实现？Redis 服务器会单线程原子性的执行 Lua 脚本，保证 Lua 脚本在处理的过程中不受外界打扰而中断。\n锁的问题\n即便按照上述要求实现了分布式锁，分布式锁也不是 100% 靠谱的，Redis 大多数公司仅仅只作为缓存，不作为持久化工具。对于分布式锁存在的问题总结如下：\n\n接口超时问题\n如果获取锁和释放锁之间，接口出现超时，以至于超出了锁的过期时间，会导致并发执行临界区程序。\n不支持重入性\n可重入性，是指线程在持有锁的情况下再次请求该锁，如果一个锁支持同一个线程多次添加锁，那么这个锁就是支持重入性的。单纯的 Redis 命令不支持，需要自己进行封装\nSentinel 集群主从发生 failover\n客户端从 Master 节点获取锁，Master 将锁同步到 Slave 之前，Master 宕机了，Slave 节点被晋级为 Master 节点，此时也会出现并发执行临界区程序。\n\n上述罗列的三个问题，生产环境都是小概率场景，但是为了避免，问题（1）建议分布式锁不要应用于时间较长的接口或任务；问题（2）一般业务使用到分布式锁都不会用到重入性，如需用到，可自行封装，也可以引用 Redssion；问题（3）的解决方案可以参考 Redlock。对于使用分布式的目的可以参考这篇文章 Redis RedLock 完美的分布式锁么？，对于严格要求的场景（比如订单、金额），即便使用分布式锁，也不能保证锁的正确性，其他非严格场景，可以参考自己的业务是否能容忍这种小概率事件了。\n参考阅读\n\nhttps://redis.io/topics/distlock\nhttps://redis.io/topics/transactions\nhttps://www.xilidou.com/2017/10/29/Redis-RedLock-%E5%AE%8C%E7%BE%8E%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E4%B9%88%EF%BC%9F/\n\n"}}}